{% extends "layouts/privateLayout.njk" %}

{% block content %}
<h1>Lista de Roles</h1>
<div id="roleTableContainer"></div>
<div id="snackbar" class="snackbar"></div>

<script type="module">
    import { fetchRoles } from './js/services/roleService.js'; 
    import { getState } from './js/reducers/state.js';
    import { renderTable } from './js/renderTable.js'; 

    const roleHeaders = {
        name: 'Nombre',
        alias: 'Alias',
        description: 'DescripciÃ³n',
        permissions: 'Permisos',
        isActive: 'Estado',
    };

    document.addEventListener('DOMContentLoaded', () => {
        loadRoles();
    });

const loadRoles = async () => {
    await fetchRoles();
    const { roles: rolesResponse } = getState(); 
    console.log('rolesResponse', rolesResponse);
    
    
    const roles = rolesResponse.roles; 

    
    if (Array.isArray(roles)) {
        renderTable(roles, roleHeaders, 'roleTableContainer'); 
    } else {
        console.error('Los roles no son un array:', roles);
        showSnackbar('Error: Los roles no se cargaron correctamente.', false);
    }
};

</script>

{% endblock %}
