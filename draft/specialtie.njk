{% extends "layouts/privateLayout.njk" %}

{% block content %}
  <div class="container">
    <h1>Gestión de Especialidades</h1>
    
    <!-- Contenedor del Formulario para Crear Especialidad -->
    <div class="form-container">
      <h2>Crear Nueva Especialidad</h2>
      <form id="createSpecialtyForm">
        <table>
          <tr>
            <td>
              <label for="name">Nombre:</label>
            </td>
            <td>
              <input type="text" id="name" name="name" required>
            </td>
          </tr>
          <tr>
            <td>
              <label for="description">Descripción:</label>
            </td>
            <td>
              <textarea id="description" name="description" required></textarea>
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <button type="submit">Crear Especialidad</button>
            </td>
          </tr>
        </table>
      </form>
    </div>

    <!-- Listado de Especialidades -->
    <div class="specialty-list">
      <h2>Lista de Especialidades</h2>
      <div id="specialtiesContainer"></div>
    </div>
  </div>

  <script src="https:
  <script>
    $(document).ready(function() {
      loadSpecialties(); 

      
      $('#createSpecialtyForm').submit(function(event) {
        event.preventDefault(); 

        const formData = {
          name: $('#name').val(),
          description: $('#description').val()
        };

        $.ajax({
          url: '/api/specialties',
          method: 'POST',
          contentType: 'application/json',
          data: JSON.stringify(formData),
          success: function(data) {
            alert('Especialidad creada exitosamente');
            $('#createSpecialtyForm')[0].reset(); 
            loadSpecialties(); 
          },
          error: function(error) {
            console.error('Error al crear especialidad', error);
            alert('Error al crear especialidad');
          }
        });
      });
    });

    
    function loadSpecialties() {
      $.ajax({
        url: '/api/specialties',
        method: 'GET',
        success: function(data) {
          const container = $('#specialtiesContainer');
          container.empty(); 

          data.forEach(specialty => {
            const specialtyDiv = `
              <div class="specialty">
                <h3>${specialty.name}</h3>
                <p>${specialty.description}</p>
              </div>
            `;
            container.append(specialtyDiv);
          });
        },
        error: function(error) {
          console.error('Error al cargar las especialidades', error);
        }
      });
    }
  </script>
{% endblock %}
