<h1>Formulario Dinámico</h1>
<button id="addFormBtn">Agregar Formulario</button>
<div id="dynamicFormContainer"></div>
<div
  id="snackbar"
  class="snackbar"
></div>

<!-- Modal para formularios -->
<div
  class="modal"
  id="formModal"
  style="display: none"
>
  <div class="modal-content">
    <span class="close-button">&times;</span>
    <h2 id="modalTitle">Agregar Elemento</h2>
    <form id="dynamicForm"></form>
    <!-- El formulario se generará aquí -->
    <button id="saveItemBtn">Guardar</button>
  </div>
</div>

<script type="module">
  import { generateForm } from '../js/components/forms/genericForm.js';

  document.addEventListener('DOMContentLoaded', () => {
    setupEventListeners();
  });

  const setupEventListeners = () => {
    document.getElementById('addFormBtn').addEventListener('click', () => {
      const formFields = [
        {
          label: 'Nombre del Producto',
          id: 'productName',
          name: 'name',
          type: 'text',
          required: true,
          placeholder: 'Ingresa el nombre del producto',
        },
        {
          label: 'Características',
          id: 'productFeatures',
          name: 'features',
          type: 'array', // Indica que es un array
          subtype: 'text', // Tipo de los elementos dentro del array
          values: [''], // Valores iniciales
        },
        {
          label: 'Descripción del Producto',
          id: 'productDescription',
          name: 'description',
          type: 'textarea',
          placeholder: 'Ingresa una descripción del producto',
        },
      ];

      generateForm(formFields, 'dynamicForm'); // Generar el formulario dinámico
      Modal.open('#formModal'); // Utilizar tu modal global para abrir el formulario
    });

    document
      .getElementById('saveItemBtn')
      .addEventListener('click', saveItemHandler);
  };

  const saveItemHandler = () => {
    const form = document.getElementById('dynamicForm');
    const formData = new FormData(form);

    // Aquí procesas los datos del formulario dinámico, incluido arrays
    console.log(
      'Datos del formulario:',
      Object.fromEntries(formData.entries())
    );

    Modal.close('#formModal'); // Cierra el modal utilizando tu función global
  };
</script>
